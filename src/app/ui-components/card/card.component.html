<div class="card" [ngClass]="[sizeClass, borderClass]">
  <ng-container *ngIf="imageSrc && imagePosition === 'top'">
    <figure class="card-figure">
      <img [src]="imageSrc" [alt]="title" />
    </figure>
  </ng-container>

  <div class="card-body">
    <div class="card-title-row">
      <h3 class="card-title">{{ title }}</h3>
      <!-- time moved to top-right of header; show whenever `date` is provided, fallback to Angular date pipe -->
      <time *ngIf="date" class="card-date header-date" [attr.datetime]="dateIso">{{ formattedDate ?? (date | date:'dd-MM-yy') }}</time>
    </div>

    <!-- Subhead row: small badges / secondary text beneath the title -->
    <div class="card-subhead" *ngIf="primaryBadgeType || primaryBadgeText || secondaryBadgeType || secondaryBadgeText || formattedDate">
      <ng-container *ngIf="primaryBadgeType; else primaryText">
        <app-badge-label
          [type]="primaryBadgeType"
          [badgeType]="'type'"
          [variant]="primaryBadgeVariant || 'soft'"
          [size]="'sm'">
        </app-badge-label>
      </ng-container>
      <ng-template #primaryText>
        <span *ngIf="primaryBadgeText" class="card-badge">{{ primaryBadgeText }}</span>
      </ng-template>

      <ng-container *ngIf="secondaryBadgeType; else secondaryText">
        <app-badge-label
          [type]="secondaryBadgeType"
          [badgeType]="'status'"
          [variant]="secondaryBadgeVariant || 'soft'"
          [size]="'sm'">
        </app-badge-label>
      </ng-container>
      <ng-template #secondaryText>
        <span *ngIf="secondaryBadgeText" class="card-badge">{{ secondaryBadgeText }}</span>
      </ng-template>
    </div>

    <p class="card-description" *ngIf="description">{{ description }}</p>

    <div class="card-actions">
      <div class="card-actions__buttons">
        <app-button *ngIf="showPrimaryButton"
          [variant]="primaryButtonVariant"
          [size]="size === 'sm' ? 'sm' : 'md'"
          (click)="onPrimaryClick()"
          (keydown.enter)="onPrimaryClick()"
          [attr.aria-label]="primaryAriaLabel">
          {{ primaryButtonLabel }}
        </app-button>

        <app-button *ngIf="showSecondaryButton"
          [variant]="secondaryButtonVariant"
          [size]="size === 'sm' ? 'sm' : 'md'"
          (click)="onSecondaryClick()"
          (keydown.enter)="onSecondaryClick()"
          [attr.aria-label]="secondaryAriaLabel">
          {{ secondaryButtonLabel }}
        </app-button>
      </div>
    </div>
  </div>

  <ng-container *ngIf="imageSrc && imagePosition === 'bottom'">
    <figure class="card-figure card-figure--bottom">
      <img [src]="imageSrc" [alt]="title" />
    </figure>
  </ng-container>
</div>
